<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>HTML Vault - Combine</title>
        <style>
body {
    background-color: #0f172a;
    color: #f8fafc;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        sans-serif;
}

* {
    box-sizing: border-box;
}

:focus {
    outline: 2px solid #38bdf8;
}

section {
    max-width: 900px;
    margin: 0 auto;
}

input,
textarea {
    width: 100%;
    padding: 0.75rem;
    border-radius: 8px;
    background-color: #1e293b;
    border: 1px solid #334155;
    color: #f8fafc;
    font-family: inherit;
    transition: border-color 0.2s, box-shadow 0.2s;
}

input:hover,
textarea:hover {
    border-color: #475569;
}

input:focus,
textarea:focus {
    background-color: #0f172a;
    border-color: #38bdf8;
    box-shadow: 0 0 0 1px #38bdf8;
}

button {
    padding: 0.75rem 1.25rem;
    border-radius: 6px;
    border: none;
    background-color: #38bdf8;
    color: #0f172a;
    font-weight: 700;
    cursor: pointer;
    transition: transform 0.1s, background-color 0.2s;
}

button:hover {
    background-color: #7dd3fc;
}

button:active {
    transform: scale(0.98);
}

a.button {
    text-decoration: none;
    background-color: #38bdf8;
    color: #0f172a;
    padding: 16px 32px;
    border-radius: 6px;
    font-weight: 700;
    font-size: 1.1rem;
    transition: background 0.2s;
}
a.button.secondary {
    background-color: transparent;
    color: #f8fafc;
    border: 1px solid #334155;
}

nav {
    display: flex;
    padding: 1.25rem 2rem;
    margin-bottom: 2rem;
    gap: 1.5rem;
    border-bottom: 1px solid #1e293b;
    background-color: #0f172a;
    align-items: center;
}

nav a {
    color: #94a3b8;
    text-decoration: none;
    font-size: 0.9rem;
    font-weight: 500;
    transition: color 0.2s;
}

nav a:hover,
nav a.active {
    color: #38bdf8;
}

details.menu {
    background-color: #1e293b;
    border: 1px solid #334155;
    border-radius: 8px;
    margin-bottom: 1rem;
    transition: all 0.2s ease;
}

details.menu[open] {
    border-color: #38bdf8;
    box-shadow: 0 0 15px rgba(56, 189, 248, 0.1);
}

.menu summary {
    padding: 1rem;
    font-weight: 600;
    color: #f8fafc;
    cursor: pointer;
    list-style: none;
    display: flex;
    align-items: center;
    justify-content: space-between;
    outline: none;
}

.menu summary::after {
    content: "+";
    font-family: "Courier New", monospace;
    color: #38bdf8;
    font-size: 1.2rem;
    transition: transform 0.2s ease;
}

details.menu[open] summary::after {
    content: "âˆ’";
    transform: rotate(180deg);
}

.menu summary::-webkit-details-marker {
    display: none;
}

details.menu div,
details.menu p {
    padding: 0 1rem 1rem 1rem;
    color: #94a3b8;
    line-height: 1.6;
    font-size: 0.95rem;
}

.share-container {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.5rem;
}

.share {
    font-family: "Courier New", monospace;
    font-size: 0.85rem;
    background-color: #0f172a;
    color: #38bdf8;
    padding: 1rem;
    border-radius: 6px;
    border: 1px solid #334155;

    display: inline-block;
    flex-grow: 1;
    overflow-x: auto;
    white-space: nowrap;

    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    transition: all 0.2s ease-out;
}

.share:hover {
    border-color: #38bdf8;
    background-color: #1e293b;
}

.share::selection {
    background: #38bdf8;
    color: #0f172a;
}

</style>
        <script>
const checkIcon =
    '<svg height="24" width="24" fill="#22bb33" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"></path></svg>';

const crossIcon =
    '<svg height="24" width="24" fill="#bb2233" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"></path></svg>';

const arrowRightIcon =
    '<svg height="24" width="24" fill="#38bdf8" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12s4.48 10 10 10 10-4.48 10-10m-10 1H8v-2h4V8l4 4-4 4z"></path></svg>';

</script>
        <script>
/*! secrets.js-grempe 2019-09-07 */

// prettier-ignore
!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],function(){return t.secrets=e()}):"object"==typeof exports?module.exports=e(require("crypto")):t.secrets=e(t.crypto)}(this,function(n){"use strict";var u,b,i,a,s;function h(){u={bits:8,radix:16,minBits:3,maxBits:20,bytesPerChar:2,maxBytesPerChar:6,primitivePolynomials:[null,null,1,3,3,5,3,3,29,17,9,5,83,27,43,3,45,9,39,39,9,5,3,33,27,9,71,39,9,5,83]},b={},i=new Array(1024).join("0"),a=!0,s=["nodeCryptoRandomBytes","browserCryptoGetRandomValues","testRandom"]}function f(){return!(!b||!b.rng||"function"!=typeof b.rng)}function g(t,e){var r;if(0===e||1===e)return t;if(e&&1024<e)throw new Error("Padding must be multiples of no larger than 1024 bits.");return e=e||b.bits,t&&(r=t.length%e),r?(i+t).slice(-(e-r+t.length)):t}function c(t){var e,r,n="";for(r=t.length-1;0<=r;r--){if(e=parseInt(t[r],16),isNaN(e))throw new Error("Invalid hex character.");n=g(e.toString(2),4)+n}return n}function m(t){var e,r,n="";for(r=(t=g(t,4)).length;4<=r;r-=4){if(e=parseInt(t.slice(r-4,r),2),isNaN(e))throw new Error("Invalid binary character.");n=e.toString(16)+n}return n}function o(){return!(!n||"object"!=typeof n||"function"!=typeof n.getRandomValues&&"object"!=typeof n.getRandomValues||"function"!=typeof Uint32Array&&"object"!=typeof Uint32Array)}function l(){return"object"==typeof n&&"function"==typeof n.randomBytes}function p(t){function a(t,e,r,n){var i,a=0,o="";for(e&&(i=e.length-1);a<i||o.length<t;)o+=g(Math.abs(parseInt(e[a],r)).toString(2),n),a++;return((o=o.substr(-t)).match(/0/g)||[]).length===o.length?null:o}function e(t){var e,r=null;for(16,4,e=Math.ceil(t/8);null===r;)r=a(t,n.randomBytes(e).toString("hex"),16,4);return r}function r(t){var e,r=null;for(10,32,e=Math.ceil(t/32);null===r;)r=a(t,n.getRandomValues(new Uint32Array(e)),10,32);return r}return t&&"testRandom"===t?(b.typeCSPRNG=t,function(t){var e,r,n=null;r=Math.ceil(t/32),e=new Uint32Array(r);for(var i=0;i<e.length;i++)e[i]=123456789;for(;null===n;)n=a(t,e,10,32);return n}):t&&"nodeCryptoRandomBytes"===t?(b.typeCSPRNG=t,e):t&&"browserCryptoGetRandomValues"===t?(b.typeCSPRNG=t,r):l()?(b.typeCSPRNG="nodeCryptoRandomBytes",e):o()?(b.typeCSPRNG="browserCryptoGetRandomValues",r):void 0}function d(t,e){var r,n=[];for(e&&(t=g(t,e)),r=t.length;r>b.bits;r-=b.bits)n.push(parseInt(t.slice(r-b.bits,r),2));return n.push(parseInt(t.slice(0,r),2)),n}function w(t,e){var r,n=b.logs[t],i=0;for(r=e.length-1;0<=r;r--)i=0!==i?b.exps[(n+b.logs[i])%b.maxShares]^e[r]:e[r];return i}function y(t,e,r){var n,i,a,o,s=0;for(a=0,n=e.length;a<n;a++)if(r[a]){for(i=b.logs[r[a]],o=0;o<n;o++)if(a!==o){if(t===e[o]){i=-1;break}i=(i+b.logs[t^e[o]]-b.logs[e[a]^e[o]]+b.maxShares)%b.maxShares}s=-1===i?s:s^b.exps[i]}return s}function x(t,e,r){var n,i,a=[],o=[t];for(n=1;n<r;n++)o[n]=parseInt(b.rng(b.bits),2);for(i=e+(n=1);n<i;n++)a[n-1]={x:n,y:w(n,o)};return a}function v(t,e,r){var n,i,a,o;if(e=parseInt(e,b.radix),n=(t=parseInt(t,10)||b.bits).toString(36).toUpperCase(),o=(a=Math.pow(2,t)-1).toString(b.radix).length,i=g(e.toString(b.radix),o),"number"!=typeof e||e%1!=0||e<1||a<e)throw new Error("Share id must be an integer between 1 and "+a+", inclusive.");return n+i+r}var t={init:function(t,e){var r,n,i=[],a=[],o=1;if(h(),t&&("number"!=typeof t||t%1!=0||t<u.minBits||t>u.maxBits))throw new Error("Number of bits must be an integer between "+u.minBits+" and "+u.maxBits+", inclusive.");if(e&&-1===s.indexOf(e))throw new Error("Invalid RNG type argument : '"+e+"'");for(b.radix=u.radix,b.bits=t||u.bits,b.size=Math.pow(2,b.bits),b.maxShares=b.size-1,r=u.primitivePolynomials[b.bits],n=0;n<b.size;n++)i[a[n]=o]=n,(o<<=1)>=b.size&&(o^=r,o&=b.maxShares);if(b.logs=i,b.exps=a,e&&this.setRNG(e),f()||this.setRNG(),!(f()&&b.bits&&b.size&&b.maxShares&&b.logs&&b.exps&&b.logs.length===b.size&&b.exps.length===b.size))throw new Error("Initialization failed.")},combine:function(t,e){var r,n,i,a,o,s,h,u="",f=[],l=[];for(e=e||0,r=0,i=t.length;r<i;r++){if(s=this.extractShareComponents(t[r]),void 0===o)o=s.bits;else if(s.bits!==o)throw new Error("Mismatched shares: Different bit settings.");if(b.bits!==o&&this.init(o),-1===f.indexOf(s.id))for(f.push(s.id),n=0,a=(h=d(c(s.data))).length;n<a;n++)l[n]=l[n]||[],l[n][f.length-1]=h[n]}for(r=0,i=l.length;r<i;r++)u=g(y(e,f,l[r]).toString(2))+u;return m(1<=e?u:u.slice(u.indexOf("1")+1))},getConfig:function(){var t={};return t.radix=b.radix,t.bits=b.bits,t.maxShares=b.maxShares,t.hasCSPRNG=f(),t.typeCSPRNG=b.typeCSPRNG,t},extractShareComponents:function(t){var e,r,n,i,a,o={};if((e=parseInt(t.substr(0,1),36))&&("number"!=typeof e||e%1!=0||e<u.minBits||e>u.maxBits))throw new Error("Invalid share : Number of bits must be an integer between "+u.minBits+" and "+u.maxBits+", inclusive.");if(i=Math.pow(2,e)-1,n=(Math.pow(2,e)-1).toString(b.radix).length,(a=new RegExp("^([a-kA-K3-9]{1})([a-fA-F0-9]{"+n+"})([a-fA-F0-9]+)$").exec(t))&&(r=parseInt(a[2],b.radix)),"number"!=typeof r||r%1!=0||r<1||i<r)throw new Error("Invalid share : Share id must be an integer between 1 and "+b.maxShares+", inclusive.");if(a&&a[3])return o.bits=e,o.id=r,o.data=a[3],o;throw new Error("The share data provided is invalid : "+t)},setRNG:function(t){var e="Random number generator is invalid ",r=" Supply an CSPRNG of the form function(bits){} that returns a string containing 'bits' number of random 1's and 0's.";if(t&&"string"==typeof t&&-1===s.indexOf(t))throw new Error("Invalid RNG type argument : '"+t+"'");if((t=t||p())&&"string"==typeof t&&(t=p(t)),a){if(t&&"function"!=typeof t)throw new Error(e+"(Not a function)."+r);if(t&&"string"!=typeof t(b.bits))throw new Error(e+"(Output is not a string)."+r);if(t&&!parseInt(t(b.bits),2))throw new Error(e+"(Binary string output not parseable to an Integer)."+r);if(t&&t(b.bits).length>b.bits)throw new Error(e+"(Output length is greater than config.bits)."+r);if(t&&t(b.bits).length<b.bits)throw new Error(e+"(Output length is less than config.bits)."+r)}return b.rng=t,!0},str2hex:function(t,e){var r,n,i,a,o,s,h="";if("string"!=typeof t)throw new Error("Input must be a character string.");if("number"!=typeof(e=e||u.bytesPerChar)||e<1||e>u.maxBytesPerChar||e%1!=0)throw new Error("Bytes per character must be an integer between 1 and "+u.maxBytesPerChar+", inclusive.");for(r=2*e,n=Math.pow(16,r)-1,o=0,s=t.length;o<s;o++){if(a=t[o].charCodeAt(),isNaN(a))throw new Error("Invalid character: "+t[o]);if(n<a)throw i=Math.ceil(Math.log(a+1)/Math.log(256)),new Error("Invalid character code ("+a+"). Maximum allowable is 256^bytes-1 ("+n+"). To convert this character, use at least "+i+" bytes.");h=g(a.toString(16),r)+h}return h},hex2str:function(t,e){var r,n,i,a="";if("string"!=typeof t)throw new Error("Input must be a hexadecimal string.");if("number"!=typeof(e=e||u.bytesPerChar)||e%1!=0||e<1||e>u.maxBytesPerChar)throw new Error("Bytes per character must be an integer between 1 and "+u.maxBytesPerChar+", inclusive.");for(n=0,i=(t=g(t,r=2*e)).length;n<i;n+=r)a=String.fromCharCode(parseInt(t.slice(n,n+r),16))+a;return a},random:function(t){if("number"!=typeof t||t%1!=0||t<2||65536<t)throw new Error("Number of bits must be an Integer between 1 and 65536.");return m(b.rng(t))},share:function(t,e,r,n){var i,a,o,s,h,u=new Array(e),f=new Array(e);if(n=n||128,"string"!=typeof t)throw new Error("Secret must be a string.");if("number"!=typeof e||e%1!=0||e<2)throw new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+b.maxShares+"), inclusive.");if(e>b.maxShares)throw i=Math.ceil(Math.log(e+1)/Math.LN2),new Error("Number of shares must be an integer between 2 and 2^bits-1 ("+b.maxShares+"), inclusive. To create "+e+" shares, use at least "+i+" bits.");if("number"!=typeof r||r%1!=0||r<2)throw new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+b.maxShares+"), inclusive.");if(r>b.maxShares)throw i=Math.ceil(Math.log(r+1)/Math.LN2),new Error("Threshold number of shares must be an integer between 2 and 2^bits-1 ("+b.maxShares+"), inclusive.  To use a threshold of "+r+", use at least "+i+" bits.");if(e<r)throw new Error("Threshold number of shares was "+r+" but must be less than or equal to the "+e+" shares specified as the total to generate.");if("number"!=typeof n||n%1!=0||n<0||1024<n)throw new Error("Zero-pad length must be an integer between 0 and 1024 inclusive.");for(o=0,h=(t=d(t="1"+c(t),n)).length;o<h;o++)for(a=x(t[o],e,r),s=0;s<e;s++)u[s]=u[s]||a[s].x.toString(b.radix),f[s]=g(a[s].y.toString(2))+(f[s]||"");for(o=0;o<e;o++)u[o]=v(b.bits,u[o],m(f[o]));return u},newShare:function(t,e){var r;if(t&&"string"==typeof t&&(t=parseInt(t,b.radix)),r=t.toString(b.radix),t&&r&&e&&e[0])return v(this.extractShareComponents(e[0]).bits,r,this.combine(e,t));throw new Error("Invalid 'id' or 'shares' Array argument to newShare().")},_reset:h,_padLeft:g,_hex2bin:c,_bin2hex:m,_hasCryptoGetRandomValues:o,_hasCryptoRandomBytes:l,_getRNG:p,_isSetRNG:f,_splitNumStringToIntArray:d,_horner:w,_lagrange:y,_getShares:x,_constructPublicShareString:v};return t.init(),t});

</script>
        <script>
const base64abc = [
    "A",
    "B",
    "C",
    "D",
    "E",
    "F",
    "G",
    "H",
    "I",
    "J",
    "K",
    "L",
    "M",
    "N",
    "O",
    "P",
    "Q",
    "R",
    "S",
    "T",
    "U",
    "V",
    "W",
    "X",
    "Y",
    "Z",
    "a",
    "b",
    "c",
    "d",
    "e",
    "f",
    "g",
    "h",
    "i",
    "j",
    "k",
    "l",
    "m",
    "n",
    "o",
    "p",
    "q",
    "r",
    "s",
    "t",
    "u",
    "v",
    "w",
    "x",
    "y",
    "z",
    "0",
    "1",
    "2",
    "3",
    "4",
    "5",
    "6",
    "7",
    "8",
    "9",
    "+",
    "/",
];

const base64codes = [
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
    255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 62, 255,
    255, 255, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 255, 255, 255, 0, 255,
    255, 255, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,
    19, 20, 21, 22, 23, 24, 25, 255, 255, 255, 255, 255, 255, 26, 27, 28, 29,
    30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48,
    49, 50, 51,
];

function getBase64Code(charCode) {
    if (charCode >= base64codes.length) {
        throw new Error("Unable to parse base64 string.");
    }
    const code = base64codes[charCode];
    if (code === 255 || code === undefined) {
        throw new Error("Unable to parse base64 string.");
    }
    return code;
}

function bytesToBase64(input) {
    const bytes = new Uint8Array(input);

    let result = "";
    let i = 0;
    const l = bytes.length;
    for (i = 2; i < l; i += 3) {
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];
        result += base64abc[((bytes[i - 1] & 0x0f) << 2) | (bytes[i] >> 6)];
        result += base64abc[bytes[i] & 0x3f];
    }
    if (i === l + 1) {
        // 1 octet yet to write
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[(bytes[i - 2] & 0x03) << 4];
        result += "==";
    }
    if (i === l) {
        // 2 octets yet to write
        result += base64abc[bytes[i - 2] >> 2];
        result += base64abc[((bytes[i - 2] & 0x03) << 4) | (bytes[i - 1] >> 4)];
        result += base64abc[(bytes[i - 1] & 0x0f) << 2];
        result += "=";
    }
    return result;
}

function base64ToBytes(str) {
    if (str.length % 4 !== 0) {
        throw new Error("Unable to parse base64 string.");
    }
    const index = str.indexOf("=");
    if (index !== -1 && index < str.length - 2) {
        throw new Error("Unable to parse base64 string.");
    }
    const missingOctets = str.endsWith("==") ? 2 : str.endsWith("=") ? 1 : 0;
    const n = str.length;
    const result = new Uint8Array(3 * (n / 4));
    let buffer;
    for (let i = 0, j = 0; i < n; i += 4, j += 3) {
        buffer =
            (getBase64Code(str.charCodeAt(i)) << 18) |
            (getBase64Code(str.charCodeAt(i + 1)) << 12) |
            (getBase64Code(str.charCodeAt(i + 2)) << 6) |
            getBase64Code(str.charCodeAt(i + 3));
        result[j] = buffer >> 16;
        result[j + 1] = (buffer >> 8) & 0xff;
        result[j + 2] = buffer & 0xff;
    }
    return result.buffer.slice(0, result.length - missingOctets);
}

</script>
        <script>
function generateRandomBytes(length) {
    const bytes = new Uint8Array(length);
    window.crypto.getRandomValues(bytes);
    return bytes.buffer;
}

async function generateKeyFromPassword(password, salt, mode, options) {
    const passwordKey = await window.crypto.subtle.importKey(
        "raw",
        new TextEncoder().encode(password),
        { name: "PBKDF2" },
        false,
        ["deriveKey"]
    );

    return window.crypto.subtle.deriveKey(
        {
            name: "PBKDF2",
            salt,
            iterations: options.iterations,
            hash: "SHA-1",
        },
        passwordKey,
        {
            name: "AES-GCM",
            length: options.keySize * 8,
        },
        false,
        [mode]
    );
}

function getDefaultOptions() {
    return {
        blockSize: 16,
        saltSize: 16,
        iterations: 1000000,
        keySize: 32,
    };
}

async function encrypt(input, passwordStr, options = getDefaultOptions()) {
    const salt = generateRandomBytes(options.saltSize);
    const key = await generateKeyFromPassword(
        passwordStr,
        salt,
        "encrypt",
        options
    );

    const iv = generateRandomBytes(options.blockSize);

    const cipherBuffer = await window.crypto.subtle.encrypt(
        { name: "AES-GCM", iv },
        key,
        input
    );

    return {
        options,
        salt,
        iv,
        encryptedData: cipherBuffer,
    };
}

async function decrypt(data, passwordStr) {
    const key = await generateKeyFromPassword(
        passwordStr,
        data.salt,
        "decrypt",
        data.options
    );

    return await window.crypto.subtle.decrypt(
        {
            name: "AES-GCM",
            iv: data.iv,
        },
        key,
        data.encryptedData
    );
}

</script>
        <style>
#inputs {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 10px;
    align-items: center;
}

#inputs .row {
    justify-self: end;
}

.row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.password-container {
    padding: 0 20px 20px 20px;
}

#output span {
    background-color: #0f172a;
    color: #fb7185;
    padding: 1.25rem;
    border-radius: 8px;
    border: 1px solid #991b1b;
    font-family: "Courier New", monospace;
    font-size: 0.95rem;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 12px;
    box-shadow: 0 0 15px rgba(244, 63, 94, 0.05);
    overflow-x: auto;
}

#output span.secret {
    color: #4ade80;
    border: 1px solid #166534;
    box-shadow: 0 0 20px rgba(74, 222, 128, 0.05);
    font-style: normal;
    text-align: initial;
    white-space: pre-wrap;
}

</style>
        <script>
function combine() {
    const parts = getParts();

    updatePartsUi(parts);
    updateOutput(parts);
}

function getParts() {
    const parts = [];

    const inputs = document.querySelectorAll("#inputs input");
    for (const input of inputs) {
        const partValue = input.value.trim();
        parts.push(partValue);
    }
    return parts;
}

async function updateOutput(parts) {
    const output = document.getElementById("output");
    const span = document.createElement("span");
    output.innerHTML = "";
    output.appendChild(span);

    try {
        const secret = await decodeParts(parts);

        span.textContent = secret;
        span.className = "secret";
    } catch (error) {
        if (error.name === "OperationError") {
            span.textContent = "Invalid password";
            return;
        }
        span.textContent = error.message;
    }
}

async function decodeParts(parts) {
    const password = document.getElementById("password").value;

    const nonEmptyParts = parts.filter((part) => part !== "");
    if (nonEmptyParts.length < 2) {
        throw new Error("Please provide additional parts.");
    }

    const secretHex = secrets.combine(nonEmptyParts);
    const secret = secrets.hex2str(secretHex);

    if (!password) {
        return secret;
    }

    const dataStr = JSON.parse(secret);
    const data = {
        options: dataStr.options,
        salt: base64ToBytes(dataStr.salt),
        iv: base64ToBytes(dataStr.iv),
        encryptedData: base64ToBytes(dataStr.encryptedData),
    };
    const decryptedBuffer = await decrypt(data, password);
    return new TextDecoder().decode(decryptedBuffer);
}

function updatePartsUi(parts) {
    let hasEmptyFields = false;

    for (const [index, part] of parts.entries()) {
        const label = document.getElementById(`input-${index}-label`);

        if (part !== "") {
            try {
                const result = secrets.extractShareComponents(part);
                label.innerHTML = `<div>Part ${result.id}</div>${checkIcon}`;
            } catch (e) {
                label.innerHTML = `<div>Invalid part</div>${crossIcon}`;
            }
        } else {
            label.innerHTML = arrowRightIcon;
            hasEmptyFields = true;
        }
    }

    if (!hasEmptyFields) {
        const inputsDiv = document.getElementById("inputs");

        const label = document.createElement("div");
        label.setAttribute("id", `input-${parts.length}-label`);
        label.setAttribute("class", "row");
        label.innerHTML = arrowRightIcon;
        inputsDiv.appendChild(label);

        const input = document.createElement("input");
        input.setAttribute("placeholder", "Enter another part");
        input.setAttribute("oninput", "combine()");
        inputsDiv.appendChild(input);
    }
}

</script>
    </head>
    <body>
        <main>
            <header>
                <nav>
                    <a href="https://html-vault.com">Home</a>
                    <a href="https://html-vault.com/split">Split Tool</a>
                    <a href="https://html-vault.com/combine">Combine Tool</a>
                </nav>
            </header>

            <section>
                <h1>Combine parts</h1>
                <p>
                    Combine as many parts as needed to reconstruct the secret.
                    The order does not matter.
                </p>

                <div id="inputs">
                    <div id="input-0-label" class="row">
                        <svg
                            height="24"
                            width="24"
                            fill="#38bdf8"
                            focusable="false"
                            aria-hidden="true"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12s4.48 10 10 10 10-4.48 10-10m-10 1H8v-2h4V8l4 4-4 4z"
                            ></path>
                        </svg>
                    </div>
                    <input placeholder="Enter a part" oninput="combine()" />
                    <div id="input-1-label" class="row">
                        <svg
                            height="24"
                            width="24"
                            fill="#38bdf8"
                            focusable="false"
                            aria-hidden="true"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12s4.48 10 10 10 10-4.48 10-10m-10 1H8v-2h4V8l4 4-4 4z"
                            ></path>
                        </svg>
                    </div>
                    <input placeholder="Enter a part" oninput="combine()" />
                </div>

                <p>
                    <details class="menu">
                        <summary>Password</summary>
                        <p>
                            If the parts are encrypted, enter the password used
                            to encrypt them.
                        </p>
                        <div class="password-container">
                            <input
                                id="password"
                                type="password"
                                placeholder="Enter password"
                                oninput="combine()"
                            />
                        </div>
                    </details>
                </p>
            </section>

            <section>
                <h2>Reconstructed secret</h2>
                <div id="output"></div>
            </section>
        </main>
    </body>
</html>
